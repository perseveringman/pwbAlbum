function getRandomImg(t){var e=("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6),o=(Math.floor(100*(6*Math.random()+2)),Math.floor(100*(6*Math.random()+2))+"X"+Math.floor(100*(5*Math.random()+2))),i="http://placehold.it/"+o+"/"+e+"/fff";return i}var PwbAlbum=function(t){this.LAYOUT={SQUARE:0,PUZZLE:1,WATERFALL:2,BARREL:3},this.opts=t||{}},_option={layout:"",isFullscreen:!1,image:[],gutter:0,boxSelector:"",photoSelector:"",cols:4,minH:100,maxH:300,minNum:3,maxNum:6,size:100};PwbAlbum.prototype.setPuzzle=function(){var t=this.getImageDomElements(),e=this.getParentDomElements();return e.css("height","500px"),t.length>6?(alert("The PUZZLE only can include six pictures!"),_option.layout="SQUARE",void this.setLayout(_option.layout)):(t.removeClass(),t.addClass("photoBox"),void t.addClass("photo_"+t.length))},PwbAlbum.prototype.setSquare=function(){var t=this.getImageDomElements();t.removeClass(),t.addClass("photoBox"),t.addClass("square"),t.css("width",_option.size+"px").css("height",_option.size+"px")},PwbAlbum.prototype.setWaterFall=function(){var t=this.getParentDomElements(),e=this.getImageDomElements();e.removeClass(),e.addClass("photoBox waterfall");var o=_option.cols,i=t.width(),s=i/o;e.css("width",s).css("height","auto");var a=[],n=function(t,e){for(var o=0;o<t.length;o++)if(t[o]==e)return o};e.each(function(t,e){if(t<o)a.push($(e).outerHeight());else{var i=Math.min.apply(null,a),l=n(a,i),r=l*s+"px";$(e).css("position","absolute").css("top",i+"px").css("left",r),a[l]+=$(e).outerHeight()}})},PwbAlbum.prototype.setBarrel=function(){var t=this,e=this.getImageDomElements(),o=this.getParentDomElements();e.removeClass(),e.addClass("photoBox");var i,s=o.width()-10,a=(s/_option.minH,s/_option.maxH),n=[],l=0;e.each(function(e,o){var r=$(o).outerWidth()/$(o).outerHeight();n.length>=_option.minNum&&l>a&&(i=s/l,t.barrelNewLine(n,i),n=[],l=0),n.push($(o)),l+=r}),n.length&&(l>a?(i=s/l,t.barrelNewLine(n,i)):(i=(_option.minH+_option.maxH)/2,t.barrelNewLine(n,i)),n=[],l=0)},PwbAlbum.prototype.barrelNewLine=function(t,e){var o,i=this.getParentDomElements(),s=2*_option.gutter,a=e-s;i.addClass("clear");for(var n=0;n<t.length;n++)o=t[n].width()*a/t[n].height(),t[n].css("height",a).css("width",o).css("float","left"),i.append(t[n])},PwbAlbum.prototype.setImage=function(t,e){if("string"==typeof t)return void this.setImage([t]);$parent=this.getParentDomElements(),$parent.empty();var o=this,i=!0;_option.layout=e.layout,_option.gutter=e.gutter,_option.isFullscreen=e.isFullscreen,_option.cols=e.cols,_option.minH=e.minH,_option.maxH=e.maxH,_option.maxNum=e.maxNum,_option.minNum=e.minNum,_option.image=e.images,_option.size=e.size,this.addImage(t),$(window).load(function(){o.setLayout(o.getLayout()),i=!1}),i&&o.setLayout(o.getLayout()),_option.isFullscreen?o.enableFullscreen(_option.image):o.disableFullscreen()},PwbAlbum.prototype.getParentDomElements=function(){var t=this.opts.boxSelector||"#puzzleContainer",e=$("#"+t);return e},PwbAlbum.prototype.getImageDomElements=function(){var t=this.opts.boxSelector||"puzzleContainer",e=this.opts.photoSelector||"photoBox",o=$("#"+t+" ."+e);return o},PwbAlbum.prototype.addImage=function(t){if("string"==typeof t)return void this.addImage([t]);for(var e=this,o=this.getParentDomElements(),i=0;i<t.length;i++)o.append("<div class='photoBox'><img src="+t[i]+".jpg></div>");$(window).load(function(){e.setLayout(e.getLayout())}),1==t.length&&e.setLayout(e.getLayout())},PwbAlbum.prototype.removeImage=function(t){},PwbAlbum.prototype.setLayout=function(t){switch(this.setGutter(this.opts.gutter),this.getLayout()){case 0:this.setSquare();break;case 1:this.setPuzzle();break;case 2:this.setWaterFall();break;case 3:this.setBarrel()}},PwbAlbum.prototype.getLayout=function(){return this.LAYOUT[_option.layout]},PwbAlbum.prototype.setGutter=function(t){var e=this.getImageDomElements();e.css("border-width",t+"px").css("border-style","solid").css("border-color","transparent")},PwbAlbum.prototype.enableFullscreen=function(t){$("img").click(function(e){for(var o,i=e.target,s=$(i).attr("src"),a=0;a<t.length;a++)if(t[a]+".jpg"==s){o=a;break}$(".fullPicture").attr("src",s),$(".fullscreen").css("display","block"),$("#next").click(function(){t[o]!=t[o+1]&&$(".fullPicture").attr("src",t[++o])}),$("#prev").click(function(){t[o]!=t[o-1]&&$(".fullPicture").attr("src",t[--o])}),$(".fullscreen").click(function(t){t.target!=$("#prev")[0]&&t.target!=$("#next")[0]&&$(".fullscreen").css("display","none")})})},PwbAlbum.prototype.disableFullscreen=function(){},PwbAlbum.prototype.isFullscreenEnabled=function(){},PwbAlbum.prototype.setBarrelBin=function(t,e){if(void 0===t||void 0===e||t>e)return void console.error("...")},PwbAlbum.prototype.getBarrelBinMax=function(){},PwbAlbum.prototype.getBarrelBinMin=function(){},PwbAlbum.prototype.setBarrelHeight=function(t,e){},PwbAlbum.prototype.getBarrelHeightMax=function(){},PwbAlbum.prototype.getBarrelHeightMin=function(){};for(var imgs=[],i=0;i<2;i++)imgs.push(getRandomImg());var options={layout:"SQUARE",isFullscreen:!0,images:[],gutter:0,boxSelector:"puzzleContainer",photoSelector:"photoBox",cols:4,minH:200,maxH:400,minNum:3,maxNum:6,size:100};options.images=imgs;var pwbAlbum=new PwbAlbum(options);pwbAlbum.setImage(imgs,options),$("#fullscreen").change(function(){options.isFullscreen=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#addImage").click(function(){var t=$("#imgUrl").val();options.images.push(t),pwbAlbum.setImage(imgs,options),$("#imgUrl").val(getRandomImg()),imgs.length>6&&"PUZZLE"==options.layout&&$("#square").click()}),$("#Cols").change(function(){options.cols=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#square").click(function(){$(".gutterGroup").show(),$("#albumType li").removeClass("active"),$(this).addClass("active"),$(".layoutConfigure").hide(),$("#conSquare").show(),options.layout="SQUARE",pwbAlbum.setImage(imgs,options)}),$("#puzzle").click(function(){$(".gutterGroup").show(),$("#albumType li").removeClass("active"),$(this).addClass("active"),$(".layoutConfigure").hide(),$("#conPuzzle").show(),options.layout="PUZZLE",imgs.length>6&&(alert("The PUZZLE only can include six pictures!"),$("#square").click()),pwbAlbum.setImage(imgs,options)}),$("#waterfall").click(function(){$(".gutterGroup").show(),$("#albumType li").removeClass("active"),$(this).addClass("active"),$(".layoutConfigure").hide(),$("#conWaterfall").show(),options.layout="WATERFALL",pwbAlbum.setImage(imgs,options)}),$("#barrel").click(function(){$("#albumType li").removeClass("active"),$(this).addClass("active"),$(".layoutConfigure").hide(),$("#gutter").val(0),$(".gutterGroup").hide(),$("#conBarrel").show(),options.layout="BARREL",options.gutter=$("#gutter").val(),pwbAlbum.setImage(imgs,options)}),$("#gutter").change(function(){$(this).val()>50?(alert("??????50?"),$(this).val(50)):$(this).val()<0&&(alert("??????0?"),$(this).val(0)),options.gutter=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#maxH").change(function(){$(this).val()>400?(alert("??????400?"),$(this).val(400)):$(this).val()<200&&(alert("??????200?"),$(this).val(200)),options.maxH=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#minNum").change(function(){$(this).val()>6?(alert("??????6?"),$(this).val(6)):$(this).val()<3&&(alert("??????3?"),$(this).val(3)),options.minNum=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#size").change(function(){$(this).val()>300?(alert("??????300?"),$(this).val(300)):$(this).val()<50&&(alert("??????50?"),$(this).val(50)),options.size=$(this).val(),pwbAlbum.setImage(imgs,options)}),$("#imgUrl").val(getRandomImg());